(this.webpackJsonpsashank=this.webpackJsonpsashank||[]).push([[0],{127:function(e,t,c){},128:function(e,t,c){},129:function(e,t,c){},130:function(e,t,c){"use strict";c.r(t);var a=c(2),n=c.n(a),s=c(28),i=c.n(s),r=(c(94),c(84)),o=c(33),j=c.n(o),d=c(46),l=c(23),u=c(150),b=c(145),h=c(146),O=c(147),p=c(148),m=c(78),f=c.n(m),x=c(79),v=c.n(x),g=(c(96),c(25)),S=c(52),N=c.n(S),y=c(34),w=y.a.initializeApp({apiKey:"AIzaSyD2jjB0L91-tatoH7Zz9FMipvBJ5eJuNsI",authDomain:"whatsapp-ae920.firebaseapp.com",projectId:"whatsapp-ae920",storageBucket:"whatsapp-ae920.appspot.com",messagingSenderId:"1026202602199",appId:"1:1026202602199:web:b46b643a29e2a59de5be92",measurementId:"G-CP4LPM5M53"}).firestore(),_=y.a.auth(),M=new y.a.auth.GoogleAuthProvider,k=w,C=c(11),I=c(4);var E=function(e){e.messages;var t,c,n=Object(a.useState)([]),s=Object(l.a)(n,2),i=s[0],r=s[1],o=Object(g.c)((function(e){return e.user})),m=Object(C.f)().roomId,x=Object(a.useState)(""),S=Object(l.a)(x,2),N=S[0],w=S[1],_=Object(a.useState)(""),M=Object(l.a)(_,2),E=M[0],R=M[1],D=Object(a.useState)(""),B=Object(l.a)(D,2),T=B[0],A=B[1];Object(a.useEffect)((function(){A(Math.floor(5e3*Math.random()))}),[]);var F=function(){var e=Object(d.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),k.collection("ROOMS").doc(m).collection("messages").add({message:N,name:o.displayName,timestamp:y.a.firestore.FieldValue.serverTimestamp()}),w("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){m&&(k.collection("ROOMS").doc(m).onSnapshot((function(e){R(e.data().name)})),k.collection("ROOMS").doc(m).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){r(e.docs.map((function(e){return e.data()})))})))}),[m]),Object(I.jsxs)("div",{className:"chatt",children:[Object(I.jsxs)("div",{className:"chatt_header",children:[Object(I.jsx)(u.a,{src:"https://avatars.dicebear.com/api/human/".concat(T,".svg")}),Object(I.jsxs)("div",{className:"chatt_headerinfo",children:[Object(I.jsx)("h3",{children:E}),Object(I.jsxs)("p",{children:["last Seen"," ",new Date(null===(t=i[i.length-1])||void 0===t||null===(c=t.timestamp)||void 0===c?void 0:c.toDate()).toUTCString()]})]}),Object(I.jsxs)("div",{className:"chatt_headerright",children:[Object(I.jsx)(b.a,{children:Object(I.jsx)(h.a,{})}),Object(I.jsx)(b.a,{children:Object(I.jsx)(O.a,{})}),Object(I.jsx)(b.a,{children:Object(I.jsx)(p.a,{})})]})]}),Object(I.jsx)("div",{className:"chat_body",children:null===i||void 0===i?void 0:i.map((function(e){var t;return Object(I.jsxs)("p",{className:"chat_message ".concat(e.name===o.displayName&&"chat_receiver"),children:[Object(I.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(I.jsx)("span",{className:"chat_timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(I.jsxs)("div",{className:"chat_footer",children:[Object(I.jsx)(f.a,{}),Object(I.jsxs)("form",{children:[Object(I.jsx)("input",{onChange:function(e){return w(e.target.value)},value:N,placeholder:"Type a message"}),Object(I.jsx)("button",{onClick:F,type:"submit",children:"send a message"})]}),Object(I.jsx)(v.a,{})]})]})},R=c(81),D=c.n(R),B=c(80),T=c.n(B),A=(c(127),c(40));var F=function(e){var t,c=Object(a.useState)(""),n=Object(l.a)(c,2),s=n[0],i=n[1],r=Object(a.useState)(""),o=Object(l.a)(r,2),j=o[0],d=o[1];return Object(a.useEffect)((function(){i(Math.floor(5e3*Math.random()))}),[]),Object(a.useEffect)((function(){e.id&&(k.collection("ROOMS").doc(e.id).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){d(e.docs.map((function(e){return e.data})))})),console.log(j))})),Object(I.jsx)(A.b,{to:"/rooms/".concat(e.id),children:Object(I.jsxs)("div",{className:"sidebarchat",children:[Object(I.jsx)(u.a,{src:"https://avatars.dicebear.com/api/human/".concat(s,".svg")}),Object(I.jsxs)("div",{className:"sidebarinfo",children:[Object(I.jsx)("h2",{children:e.name}),Object(I.jsx)("p",{children:null===(t=j[0])||void 0===t?void 0:t.message})]})]})})},P=c(82),L=c.n(P);c(128);var W=function(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),c=t[0],n=t[1];Object(a.useEffect)((function(){var e=k.collection("ROOMS").onSnapshot((function(e){n(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]);var s=Object(g.c)((function(e){return e.user}));return Object(I.jsxs)("div",{className:"sidebar",children:[Object(I.jsxs)("div",{className:"sidebar_header",children:[Object(I.jsx)(b.a,{children:Object(I.jsx)(u.a,{alt:"Remy Sharp",src:null===s||void 0===s?void 0:s.photoURL})}),Object(I.jsxs)("div",{className:"headerright",children:[Object(I.jsx)(b.a,{children:Object(I.jsx)(T.a,{})}),Object(I.jsx)(b.a,{children:Object(I.jsx)(D.a,{})}),Object(I.jsx)(b.a,{children:Object(I.jsx)(L.a,{})})]})]}),Object(I.jsx)("div",{className:"search",children:Object(I.jsxs)("div",{style:{backgroundColor:" white"},className:"searchconstainer",children:[Object(I.jsx)(h.a,{}),Object(I.jsx)("input",{type:"text",placeholder:"search or start new chat"})]})}),Object(I.jsxs)("div",{className:"chat",children:[Object(I.jsx)("div",{className:"addnew",onClick:function(){var e=prompt("please enter name for chat room");if(e){var t=e.split("").reverse().join("");k.collection("ROOMS").add({name:e,password:t})}},children:Object(I.jsx)("h2",{children:"Add New Chat"})}),c.map((function(e){return Object(I.jsx)(F,{id:e.id,name:e.data.name},e.id)}))]})]})},J=c(83),U=c.n(J),z=c(149),G=(c(129),"SET_USER");var H=function(){var e=Object(g.b)();return Object(I.jsx)("div",{className:"login",children:Object(I.jsxs)("div",{className:"login_container",children:[Object(I.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/598px-WhatsApp.svg.png",alt:""}),Object(I.jsx)("div",{className:"login_first",children:Object(I.jsx)("h1",{children:"sign in to Whatsapp"})}),Object(I.jsx)(z.a,{onClick:function(){_.signInWithPopup(M).then((function(t){console.log(t),e({type:G,payload:t.user})})).catch((function(e){return alert(e.message)}))},children:"Sign In with Google"})]})})};var K=function(){var e=Object(g.c)((function(e){return e.user})),t=Object(a.useState)([]),c=Object(l.a)(t,2),n=c[0],s=c[1];return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("http://localhost:4000/messages/sync");case 2:t=e.sent,s(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(a.useEffect)((function(){var e=new U.a("1017288953a9052f5f73",{cluster:"ap2"}).subscribe("messages");return e.bind("inserted",(function(e){s([].concat(Object(r.a)(n),[e]))})),function(){e.unbind_all(),e.unsubscribe()}}),[n]),console.log(n),Object(I.jsx)("div",{className:"app",children:e?Object(I.jsx)("div",{className:"app_body",style:{display:"flex"},children:Object(I.jsxs)(A.a,{children:[Object(I.jsx)(W,{}),Object(I.jsxs)(C.c,{children:[Object(I.jsx)(C.a,{path:"/rooms/:roomId",children:Object(I.jsx)(E,{messages:n})}),Object(I.jsx)(C.a,{path:"/",children:Object(I.jsx)("h1",{children:" Welcome"})})]})]})}):Object(I.jsx)(H,{})})},V=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,151)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),a(e),n(e),s(e),i(e)}))},Z=c(47),q=c(57),Q={user:null},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0,c=t.type,a=t.payload;switch(c){case G:return Object(q.a)(Object(q.a)({},e),{},{user:a});default:return e}},Y=Object(Z.b)(X);i.a.render(Object(I.jsx)(n.a.StrictMode,{children:Object(I.jsx)(g.a,{store:Y,children:Object(I.jsx)(K,{})})}),document.getElementById("root")),V()},94:function(e,t,c){},96:function(e,t,c){}},[[130,1,2]]]);
//# sourceMappingURL=main.f3b7a3e6.chunk.js.map